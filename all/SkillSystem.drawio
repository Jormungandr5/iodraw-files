<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36" version="26.2.14">
  <diagram name="第 1 页" id="-2ZJdPU1EGzkgh0zn1c5">
    <mxGraphModel dx="3012" dy="4247" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-1" value="&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;SkillManager&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;public static SkillManager instance&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;// Skills:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Dash_Skill dask;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Clone_Skill clone;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-990" y="30" width="500" height="290" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-6" target="gPpyHjLKl8rGHEcK-XGe-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-6" target="gPpyHjLKl8rGHEcK-XGe-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="BzqCn0NFTJxUhRajQsSP-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gPpyHjLKl8rGHEcK-XGe-6" target="BzqCn0NFTJxUhRajQsSP-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-6" value="&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Skill&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;protected float cooldown;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;protected float cooldownTimer;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;// Methods&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;Update()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;virtual void CanUseSkill(); // 如果cooldownTimer &amp;lt; 0, 调用UseSkill();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;virtual void UseSkill();&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="30" width="470" height="280" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-2" value="&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Clone_Skill&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;// Clone info&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;private GameObject clonePrefab;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;private float cloneDuration;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;private bool canAttack;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// Methods&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;public void CreateClone(Transform _clonePosition)&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;{&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;GameObject newClone =&lt;span style=&quot;background-color: rgb(241, 255, 57);&quot;&gt; Instantiate&lt;/span&gt;(clonePrefab);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;newClone.GetComponent&amp;lt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;Clone_Skill_Controller&lt;/span&gt;&amp;gt;().&lt;span style=&quot;background-color: rgb(1, 255, 18);&quot;&gt;SetupClone&lt;/span&gt;(_clonePosition, cloneDuration, canAttack);&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;}&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="-290" y="470" width="540" height="330" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-5" value="&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b style=&quot;&quot;&gt;Clone_Skill_Controllers&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;background-color: light-dark(rgb(255, 255, 0), rgb(237, 237, 237)); font-size: 20px;&quot;&gt;// 挂载在prefab上:&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;制作了一个Clone prefab:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;只挂载了：&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;1.transform组件&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;2.Sprite Render组件&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3.Animator&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;4.Clone_Skill_Controller(Script)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 0);&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;没有挂载Rigibody2D组件（不会受重力及其它物理属性影响）&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px; background-color: rgb(255, 255, 0);&quot;&gt;也没有Collider2D组件（保证不会让敌人攻击到残影）&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;在PlayerDashState的Enter()函数中，调用Clone_Skill中的CreatClone方法时，实例化一个clonePrefab对象newClone，并调用Clone_Skill_Controllers的SetupClone()方法：&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;将newClone的位置设置在原地，并且播放对应动画，调整形象面对方向FaceClosestTarget()&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;*/&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;SpriterRenderer sr;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;float cloneTimer;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;//Methods&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Update()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: rgb(146, 255, 3);&quot;&gt;SetupClone&lt;/span&gt;(Transform _newTransform, float _cloneDuration, bool _canAttack);&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;background-color: rgb(162, 255, 3); font-size: 20px;&quot;&gt;FaceClosestTarget()&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="-1130" y="470" width="730" height="890" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" target="gPpyHjLKl8rGHEcK-XGe-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="909.75" y="1990" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="909.75" y="2020" />
              <mxPoint x="304.75" y="2020" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-9" target="gPpyHjLKl8rGHEcK-XGe-24" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="909.75" y="1990" as="sourcePoint" />
            <mxPoint x="494.75" y="2230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="gPpyHjLKl8rGHEcK-XGe-25" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="909.75" y="1990" as="sourcePoint" />
            <mxPoint x="1240.75" y="2070" as="targetPoint" />
            <Array as="points">
              <mxPoint x="909.75" y="2020" />
              <mxPoint x="1515.75" y="2020" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-9" value="&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Sword_Skill&amp;nbsp; 通用属性&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Sword info&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;public SwordType swordType;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private GameObject swordPrefab;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private Vector2 launchForce;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private float swordGravity;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private float returnSpeed;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private freezeTimeDuration;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private Vector2 finalDir;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Aim dots&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;private int numberOfDots;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;private float spaceBetweenDots&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;private GameObject dotPrefab;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private Transform dotsParent;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private GameObject[] dots;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Methods&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;public Vector2 AimDirection(); // 鼠标右键位置 减去 角色位置&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private Vector2 DotsPosition(float t); // 计算每个dot的位置&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;private void GenerateDots(); // 利用prefab实例化dots，生成后先失活&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;DotsActive(bool _isActive);// 激活dots&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;SetupGravity(); // 设置不同种类sword的重力&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;在Update()中，监听 ：&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;1. 鼠标右键hold，实时计算点的位置（在playerAimSwordState的Enter方法中&lt;span style=&quot;background-color: transparent;&quot;&gt;player.skill.sword.DotsActive(true);将dots激活&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;）；&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;2. 松开鼠标右键，计算finalDir；aimSwordState的update中，监听松开鼠标右键，返回idleState；&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;实际上：从aimSword状态松开鼠标右键，到throwSword状态&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;状态机上：throwSword状态其实就是idleState；&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;在每次进入aimSword状态时，&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Animator上，aimSword -&amp;gt; throwSword的条件是AimSword = false，在aimSword状态的Exit()方法中，调用base.Exit()时，会将其置为false;故退出&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;aimSword状态时，动画自动进入throwSword；在playerthrowSword中的指定帧，调用CreateSword()方法&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;在PlayerAnimationTrigger类中 ，有ThrowSword方法，在指定动画帧调用该事件，调用&lt;span style=&quot;background-color: transparent;&quot;&gt;SkillManager.instance.sword.CreateSword();方法&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;*/&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;public void CreateSword(); // 该方法中实例化剑刃，通过&lt;span style=&quot;background-color: transparent;&quot;&gt;Sword_Skill_Controller中的SetupSword方法来对剑刃进行设置，并将dots失活，&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;并且如果SwordType == Bounce; 则在SetupSword方法中调用SetupBounce方法，&lt;b&gt;在SetupBounce方法中将enemyTarget列表重置为null，每次进&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;入bounce时都会将该列表置空，消除上一次剑刃bounce记录的敌人列表&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;CreateSword()方法//&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;在playerthrowSword中的指定帧调用&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;1.实例化一把剑newSword&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;2.获得实例化的剑对象newSword上的Sword_Skill_Controller 脚本newSwordScript&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;3.根据剑的类型，调用剑对象上的脚本的方法，对剑的类型参数进行设置，newSwordScript.SetupBounce/Spin/Pierce&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;4. 调用剑对象上的脚本的方法，设置剑的通用属性, newSwordScript.SetupSword();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;5.给player分配一把剑&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;6.在实例化一把剑的同时，将瞄准点路线关闭&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;*/&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="330" y="470" width="1160" height="1430" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-10" target="gPpyHjLKl8rGHEcK-XGe-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-10" target="gPpyHjLKl8rGHEcK-XGe-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-10" target="gPpyHjLKl8rGHEcK-XGe-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-10" value="&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Sword_Skill_Controllers 通用属性&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px; background-color: light-dark(rgb(255, 255, 0), rgb(237, 237, 237));&quot;&gt;/* 挂载在prefab上&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px; background-color: light-dark(rgb(255, 255, 0), rgb(237, 237, 237));&quot;&gt;prefab上挂载了Rigidbody2D&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 16px; background-color: rgb(255, 255, 0);&quot;&gt;CircleCollider2D&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px; background-color: light-dark(rgb(255, 255, 0), rgb(237, 237, 237));&quot;&gt;*/&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&amp;nbsp;private Animator anim;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&amp;nbsp;private Rigidbody2D rb;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&amp;nbsp;private CircleCollider2D cd;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&amp;nbsp;private Player player;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;int returnSpeed;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;bool canRotate;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;bool isReturining;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;float freezeTimeDuration;// 敌人被sword击中后停滞的时间&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;//Methods&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;spacingTop=-500;" parent="1" vertex="1">
          <mxGeometry x="2344.99" y="-130" width="950.01" height="1040" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-12" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;swordType = SwordType.Bounce&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Bounce info&lt;/font&gt;&lt;/div&gt;&lt;div&gt;int bounceAmount; // 反弹次数&lt;/div&gt;&lt;div&gt;float bounceGravity;&lt;/div&gt;&lt;div&gt;bounceSpeed;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Methods&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;SetupBounce&lt;/font&gt;&lt;/b&gt;(true, bounceAmonut, bounceSpeed);// 设置bounceSword的相关参数&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="29.75" y="2230" width="550" height="200" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-23" value="&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;public enum SwordType&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; Regular,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; Bounce,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; Pierce,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; Spin&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1200" y="630" width="220" height="160" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-24" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;swordType = SwordType.Pierce&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Pierce info&lt;/font&gt;&lt;/div&gt;&lt;div&gt;int pierceAmount; // 可以贯穿敌人的数量&lt;/div&gt;&lt;div&gt;float pierceGravity; // 贯穿剑的重力，贯穿剑的重力更低&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Methods&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;SetupPierce&lt;/font&gt;&lt;/b&gt;(pierceAmount);// 设置bounceSword的相关参数&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="634.75" y="2230" width="550" height="200" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-25" value="&lt;b&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;swordType = SwordType.Spin&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Spin info&lt;/font&gt;&lt;/div&gt;&lt;div&gt;float spinDuration; // 旋转剑留在原地旋转的时间&lt;/div&gt;&lt;div&gt;float spinGravity; // 旋转剑的重力&lt;/div&gt;&lt;div&gt;maxTravelDistance; // 未击中敌人时，旋转剑的最大距离&amp;nbsp;&lt;/div&gt;&lt;div&gt;hitCooldown; //旋转剑留在原地攻击敌人的频率（冷却时间）&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Methods&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 16px;&quot;&gt;&lt;b&gt;SetupSpin&lt;/b&gt;&lt;/span&gt;(true, maxTravelDistance, spinDuration, hitCooldown);// 设置bounceSword的相关参数&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1240.25" y="2230" width="550" height="200" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-26" target="gPpyHjLKl8rGHEcK-XGe-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-26" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Pierce&lt;/font&gt;&lt;/b&gt; info&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;int pierceAmount;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;//Methods&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;SetupPierce();&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1900" y="1150" width="440" height="430" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-28" target="gPpyHjLKl8rGHEcK-XGe-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-28" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Bounce&lt;/font&gt;&lt;/b&gt;&amp;nbsp;info&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;float bounceSpeed;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;bool isBouncing; // 是否是反弹剑&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;int bounceAmount;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;float bounceRadius;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;List&amp;lt;Transform&amp;gt; enemyTarget&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;int TargetIndex;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Methods&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;SetupBounce();&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;给bounce的各种属性赋值；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;enemyTarget = new List&amp;lt;Transform&amp;gt;()&lt;br&gt;给enemyTarget赋空值；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;*/&lt;/font&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="2570" y="1150" width="500" height="440" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-29" target="gPpyHjLKl8rGHEcK-XGe-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-29" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Spin&lt;/font&gt;&lt;/b&gt;&amp;nbsp;info&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float maxTravelDistance;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float spinDuration;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float spinTimer;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float spinRadius;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float spinDirection;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float hitTimerl&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;float hitCooldown;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;bool wasStopped;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;bool isSpinning; // 是否是旋转剑&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;//Methods&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;SetupSpin();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;给isSpining/maxTravelDistance/spinDuration/hitCooldown赋值&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;*/&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3190" y="1150" width="670" height="430" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-32" target="gPpyHjLKl8rGHEcK-XGe-40" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2720" y="2400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-32" target="gPpyHjLKl8rGHEcK-XGe-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="gPpyHjLKl8rGHEcK-XGe-32" target="gPpyHjLKl8rGHEcK-XGe-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-32" value="&lt;font style=&quot;font-size: 20px;&quot;&gt;//Methods&lt;/font&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;void OnTrrigerEnter2D(Collider2D collision)&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;/*&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;1. 如果isReturning = true, 直接return;返回时撞到敌人不做处理;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;2. 如果不是sword返回状态，调用&lt;/b&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;SwordSkillDamage()方法;&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;更正：&lt;font color=&quot;#ba0000&quot;&gt;如果是撞到敌人 ：&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;&lt;font color=&quot;#ba0000&quot;&gt;调用SwordSkillDamage()方法；&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;&lt;font color=&quot;#ba0000&quot;&gt;如果是isBouncing &amp;amp;&amp;amp;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot; color=&quot;#ba0000&quot;&gt;&lt;b&gt;enemyTarget.Count &amp;lt;= 0// 如果是bounceSword并且第一次撞到敌人：&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot; color=&quot;#ba0000&quot;&gt;&lt;b&gt;调用SetupTargetsForBounce(); // 为bounceSword寻找敌人列表（在原作者该函数中删除这段逻辑）&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;3. 调用&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;SetupTargetsForBounce(collision); // 为bounceSword寻找敌人列表&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;4. 调用&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;StuckInto(collision);&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;*/&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Update();&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;1. 如果canRotate = true; 保持让剑的transform.right = rb.velocity;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;2. 如果isReturning = true; 执行返回剑的逻辑（移动 &amp;amp;&amp;amp; 接近player时回收）&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3. 如果是bounceSword，并且敌人列表中对象大于1，调用&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;BounceLogic()&lt;/font&gt;&lt;/b&gt;方法；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;4. 否则不是bounceSword，如果是spinSword, 调用&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;SpinLogic()&lt;/font&gt;&lt;/b&gt;方法；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;*/&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="2331.88" y="1850" width="976.25" height="660" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-40" value="&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;&lt;b style=&quot;&quot;&gt;BounceSword&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;// Methods&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;SetupTargetsForBounce()&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;/* 如果isBouncing == true &amp;amp;&amp;amp; enemyTarget &amp;lt;= 0 ： 当前enemyTarget list中没有对象, 来判断反弹剑是否是第一次碰撞到敌人，因为每次在设置剑类型为反弹剑时会将敌人列表清空 */ &lt;font color=&quot;rgba(0, 0, 0, 0)&quot;&gt;修正：上面&lt;/font&gt;&lt;/font&gt;&lt;font style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 18px;&quot;&gt;将剑的bounceRadius范围内的敌人Add到&lt;/font&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 18px;&quot;&gt;enemyTarget&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 18px;&quot;&gt;&amp;nbsp; List（无序的）&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;BounceLogic()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;1. 在update中调用时,让sword的从当前位置向当前敌人List中索引为&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 18px;&quot;&gt;targetIndex的敌人位置移动；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 18px;&quot;&gt;2. 如果到达了该敌人位置，则调用&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 18px;&quot;&gt;SwordSkillDamage()方法，&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;targetIndex++ &amp;amp;&amp;amp; bounceAmount--;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;如果 bounceAmount = 0 :&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;isBouncing = false &amp;amp;&amp;amp; isReturning = true; 返回Sword；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;否则，如果列表遍历完一次，继续从头遍历列表&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;*/&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="2450.01" y="2670" width="740" height="530" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-41" value="&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;private void StuckInto(Collider2D collision)&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;1. 如果是pierceSword，并且pierceAmount &amp;gt; 0;则将pierceAmount 减一，&lt;b&gt;然后return;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;2. 如果是spinSword，（不可能是pierceSword），调用StopWhenSpinning(); 让spinSword在攻击到第一个enemy时停在原地; &lt;b&gt;然后return&lt;/b&gt;;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3. 有以下可能：&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3.1 是pierceSword，已经贯穿了pierceAmount个敌人，此时pierceAmount = 0；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3.2 不是pierceSword也不是spinSword，则可能是bounceSword/regularSword;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;此时，&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;（1）.将canRotate = false; 让剑的右侧不再一直指向剑的速度方向;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;（2）.将剑的rigibody2D失活，让剑的碰撞体失活;这样以后不会再检测到剑攻击到敌人/墙体&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;（3）.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;将剑的刚体设为Kinematic运动学刚体，不受重力、碰撞等影响，只受代码控制&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;（4）. 停滞剑的一切动作&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;4. 如果是反弹剑，并且敌人列表数量大于1，则return; 这样不会执行后序让剑停止旋转的动画&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;5. 否则，如果不是反弹剑/ 是反弹剑但是敌人列表数量小于等于1，则退出剑旋转动画;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;6. 将剑的parent设为攻击到的敌人，让剑跟随敌人一切移动&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3470" y="1916.25" width="1200" height="527.5" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-43" value="&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;public void SetupSword(Vector2 _dir, float _gravityScale)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;rb.velocity = _dir;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;rb.gravityScale = _gravityScale;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;};&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2440" y="350" width="280" height="130" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-44" value="&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;DestryoMe();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;ReturnSword(); // 停止剑的rigidbody2D；让剑重新失去parent;isReturning = true;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2870" y="355" width="360" height="90" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-45" value="&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;SetupSword();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;/*&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;1.给剑的各种公共属性赋值&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;2.如果是pierce，会有pierceAmount &amp;gt; 0;此时剑不需要旋转，则在pierceAmount &amp;lt;= 0时，让剑切换到旋转动画&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;3.计算SpinDirection;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;*/&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2860" y="480" width="380" height="140" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-46" value="&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;SwordSkillDamage(enemy);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;// 调用enemy.Damage()方法，启用协程&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 15px;&quot;&gt;enemy.StartCoroutine(&quot;FreezeTimerFor&quot;, freezeTimeDuration);使敌人停滞&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2370" y="590" width="390" height="135" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-47" value="&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Update();&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;onTriggerEnter2D();&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2900" y="670" width="280" height="157.5" as="geometry" />
        </mxCell>
        <mxCell id="gPpyHjLKl8rGHEcK-XGe-49" value="&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;&lt;b style=&quot;&quot;&gt;SpinSword&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;// Methods&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot; style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;SpinLogic&lt;/span&gt;()&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;/*&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;1. 如果player的位置和sword的位置超过了maxTravelDistance &amp;amp;&amp;amp; !wasStopped剑没有停下来，调用StopWhenSpinning()方法；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;2. 如果当前Sword已经停止（wasStopped = true），则每帧减少spinTimer;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;如果spinTimer &amp;lt; 0：&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;设置isReturning = true &amp;amp;&amp;amp; isSpinning = false;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3. 更新中每帧减少hitTimer;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;如果hitTimer &amp;lt; 0; 将hitTimer重置为hitCooldown;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;对在Sword的spinRadius范围内的敌人调用&lt;span style=&quot;background-color: transparent;&quot;&gt;SwordSkillDamage()方法;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;注意对于spinSword，在&lt;/span&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: &amp;quot;Comic Sans MS&amp;quot;;&quot;&gt;StuckInto()方法中碰撞到敌人时不会将Rigidbody失活&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: &amp;quot;Comic Sans MS&amp;quot;;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;Comic Sans MS&quot;&gt;StopWhenSpinning()&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;/*&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;1. 设置wasStopped = true;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;2. 凝滞Sword的Rigidbody2D;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;3. 如果&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;spinTimer &amp;lt; 0; 设置&lt;/span&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;spinTimer = spinDuration;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; font-size: 20px;&quot;&gt;注意：只有spinSword刚进入停留在原地状态时，更新spinTimer 为spinDuration;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;*/&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="3470" y="2680" width="1050" height="650" as="geometry" />
        </mxCell>
        <mxCell id="BzqCn0NFTJxUhRajQsSP-2" value="&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Blackhole_Skill&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// values&lt;/div&gt;&lt;div&gt;int amountOfAttacks;&lt;/div&gt;&lt;div&gt;float cloneCooldown;&lt;/div&gt;&lt;div&gt;float blackholeDuration; // 黑洞持续时间&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;GameObject blackholePrefab;&lt;/div&gt;&lt;div&gt;float maxSize;&lt;/div&gt;&lt;div&gt;float growSpeed;&lt;/div&gt;&lt;div&gt;float shrinkSpeed;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Blackhole_Skill_Controller currentBlackhole; // 当前blackhole上的控制脚本&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// Methods&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;CanUseKill();&lt;/div&gt;&lt;div&gt;UseSkill();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;实例化一个newBlackhole;&lt;/div&gt;&lt;div&gt;调用newBlackhole上挂载的Blackhole_Skill_Controller脚本的SetupBlackhole()方法&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;SkillCompleted();&lt;/div&gt;&lt;div&gt;// 如果没有currentBlackhole，即还没有实例化/ currentBlackhole.playerCanExitState = false，return false;&lt;/div&gt;&lt;div&gt;否则return true，并将currentBlackhole 置空&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="1100" y="-1190" width="1090" height="660" as="geometry" />
        </mxCell>
        <mxCell id="BzqCn0NFTJxUhRajQsSP-5" value="&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Blackhole_Skill_Controller&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// Values&lt;/div&gt;&lt;div&gt;bool playerCanDisappear;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;&lt;b&gt;List&amp;lt;Transform&amp;gt; targets;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;// Blackhole相关&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;//Values&lt;/b&gt;&lt;/div&gt;&lt;div&gt;float blackholeTimer;&lt;/div&gt;&lt;div&gt;float maxSize;&lt;/div&gt;&lt;div&gt;float growSpeed;&lt;/div&gt;&lt;div&gt;float shrinkSpeed;&lt;/div&gt;&lt;div&gt;bool canGrow;&lt;/div&gt;&lt;div&gt;bool canShrink;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Methods&lt;/div&gt;&lt;div&gt;SetupBlackhole();// 设置blackhole的maxSize, growSpeed, shrinkSpeed, amountOfAttacks, cloneAttackCooldown, blackholeTimer;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;// Clone（制作克隆体）相关&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;// Values&lt;/b&gt;&lt;/div&gt;&lt;div&gt;bool cloneAttackReleased;&lt;/div&gt;&lt;div&gt;int amountOfAttacks; // 黑洞技能中，能攻击敌人的数量&lt;/div&gt;&lt;div&gt;float cloneAttackCooldown;&lt;/div&gt;&lt;div&gt;float cloneAttackTimer; // 召唤克隆体攻击的cd&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// &lt;b&gt;Methods()&lt;/b&gt;&lt;/div&gt;&lt;div&gt;void ReleaseCloneAttack();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;1. 如果没有攻击目标，return;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.DestroyHotKeys()；&lt;/div&gt;&lt;div&gt;3.令cloneAttackReleased = true;&lt;/div&gt;&lt;div&gt;4.令canCreateHotKeys = false; 此时已经在执行对Enemy列表中的敌人攻击的逻辑，如果有新的敌人进入黑洞范围不会再生成热键；&lt;/div&gt;&lt;div&gt;5. 在执行攻击逻辑时，如果playerCanDisappear = true；则执行将player“隐身”的逻辑：&lt;/div&gt;&lt;div&gt;&lt;div&gt;PlayerManager.instance.player.MakeTransparent(true);&lt;/div&gt;&lt;div&gt;playerCanDisappear = false;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;void&amp;nbsp;CloneAttackLogic();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;在Update()中调用该方法：（这里update就相当于循环调用该方法）&lt;/div&gt;&lt;div&gt;如果cloneAttackTimer &amp;lt; 0 &amp;amp;&amp;amp; cloneAttackReleased &amp;amp;&amp;amp; amountOfAttacks &amp;gt; 0;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;cloneAttackTimer = cloneAttackCooldown;&lt;/div&gt;&lt;div&gt;在Enemy 列表 targets中，随机获取一个下标randomIndex，得到对应敌人的transform，在该敌人的transform左侧/右侧生成克隆体，调用SkillManager.instance.clone.CreateClone()方法，amountOfAttacks--;&lt;/div&gt;&lt;div&gt;如果&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;amountOfAttacks &amp;lt; 0, 1s后调用&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;FinishBlackHoleAbility()方法&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Invoke(&quot;FinishBlackHoleAbility&quot;, 1f);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;//HotKey（生成热键）相关&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;//Values&lt;/b&gt;&lt;/div&gt;&lt;div&gt;float headOffset;&lt;/div&gt;&lt;div&gt;bool canCreateHotkeys;&lt;/div&gt;&lt;div&gt;GameObject hotKeyPrefab;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;List&amp;lt;GameObject&amp;gt; createdHotKey;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;List&amp;lt;KeyCode&amp;gt; KeyCodeList; /*&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;这是一个存储了设置的HotKey的List，在为每个blackhole内的敌人生成热键时，&lt;/div&gt;&lt;div&gt;随机从该List中取出一个元素作为hotkey的key在敌人的头顶生成，并且将该元素从List中删除&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// Methods&lt;/div&gt;&lt;div&gt;Update();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;1. 减少定时器cloneAttackTimer 和 blackholeTimer&lt;/div&gt;&lt;div&gt;2. 如果blackholeTimer &amp;lt; 0，则黑洞技能时间结束&lt;/div&gt;&lt;div&gt;将blackholeTimer = Infinity,（防止再次进入此条件）&lt;/div&gt;&lt;div&gt;在黑洞时间结束的情况下：&lt;/div&gt;&lt;div&gt;2.1 用户输入了攻击目标，调用ReleaseCloneAttack()方法；&lt;/div&gt;&lt;div&gt;2.2 没有攻击目标，调用FinishBlackHoleAbility()方法，结束技能；&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3.&amp;nbsp;&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="1610" y="-3160" width="1090" height="1670" as="geometry" />
        </mxCell>
        <mxCell id="BzqCn0NFTJxUhRajQsSP-6" value="&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Blackhole_HotKey_Controller&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Methods&lt;/div&gt;&lt;div&gt;SetupHotKey();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;1.获取HotKey上的SpriteRenderer；&lt;/div&gt;&lt;div&gt;2.获取&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;HotKey孩子上的&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;TextMeshProUGUI组件（用来显示文字）text；&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;3. 设置&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;_myHotKey属性，并将&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;_myHotKey作为文字用text显示&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;4. 设置_myEnemy属性（这是该hotKey对应的敌人的transform）&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;5.获取&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Blackhole_Skill_Controller脚本&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;_blackhole&lt;/span&gt;&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Update();&lt;/div&gt;&lt;div&gt;/*&lt;/div&gt;&lt;div&gt;在Update函数中，如果玩家按下了HotKey键，则通过blackhole对象，调用blackhole.AddEnemyToList(myEnemy)方法，&lt;/div&gt;&lt;div&gt;将该敌人添加到要攻击的敌人列表中;&lt;/div&gt;&lt;div&gt;并将HotKey隐藏不显示&lt;/div&gt;&lt;div&gt;*/&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="320" y="-1980" width="1090" height="660" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
